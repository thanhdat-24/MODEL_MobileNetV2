{% extends "layout.html" %}

{% block title %}Fruitkha - Nh·∫≠n Di·ªán Hoa Qu·∫£ Cao C·∫•p{% endblock %}

{% block extra_css %}
<style>
    /* Search Results Container */
    .search-results-container {
        margin-top: 40px;
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        border-left: 4px solid #F28123;
        animation: fadeInUp 0.5s ease-out;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .search-results-header {
        margin-bottom: 20px;
    }

        .search-results-header h4 {
            font-size: 20px;
            color: #051922;
            margin-bottom: 8px;
            font-weight: 600;
        }

    .search-reason {
        color: #666;
        font-size: 15px;
        font-style: italic;
    }

    .search-results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }

    .search-result-card {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .search-result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .search-result-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }

    .search-info {
        padding: 15px;
    }

        .search-info a {
            display: block;
            font-weight: 600;
            color: #051922;
            text-decoration: none;
            margin-bottom: 8px;
            line-height: 1.4;
            font-size: 16px;
        }

            .search-info a:hover {
                color: #F28123;
            }

    .search-source {
        font-size: 13px;
        color: #888;
        margin-bottom: 8px;
    }

    .search-confidence {
        background: #F28123;
        color: white;
        padding: 3px 10px;
        border-radius: 15px;
        font-size: 13px;
        display: inline-block;
        font-weight: 500;
    }

    /* Recognition Mode Toggle */
    .recognition-mode-toggle {
        display: flex;
        background: #f5f5f5;
        border-radius: 30px;
        padding: 5px;
        margin-bottom: 25px;
        width: fit-content;
        margin: 0 auto 25px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    }

    .recognition-mode-btn {
        padding: 10px 20px;
        border: none;
        background: transparent;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        color: #777;
        font-size: 14px;
        text-align: center;
        min-width: 150px;
    }

    .recognition-mode-btn.active {
        background: #F28123;
        color: white;
        box-shadow: 0 3px 10px rgba(242, 129, 35, 0.3);
    }

    .recognition-mode-btn i {
        margin-right: 5px;
    }

    /* Multi Image Container */
    .multi-image-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 15px;
        margin-top: 15px;
        margin-bottom: 15px;
        max-height: 300px;
        overflow-y: auto;
        padding: 10px;
    }

    .multi-image-preview {
        position: relative;
        overflow: hidden;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    .preview-thumbnail {
        width: 100%;
        height: 100px;
        object-fit: cover;
        display: block;
        border-radius: 8px;
    }

    .remove-image-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        background: rgba(255,255,255,0.8);
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: #e74c3c;
        font-size: 12px;
        transition: all 0.2s ease;
    }

    .remove-image-btn:hover {
        background: #e74c3c;
        color: white;
    }

    /* Group Results */
    .result-card.group-result .result-name {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .fruit-count {
        background: #F28123;
        color: white;
        padding: 2px 10px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 600;
    }

    /* Thumbnails Container */
    .thumbnails-container {
        margin-top: 30px;
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        animation: fadeInUp 0.5s ease-out;
        border-left: 4px solid #4CAF50;
        display: none;
    }

    .thumbnails-header {
        margin-bottom: 20px;
    }

    .thumbnails-header h4 {
        font-size: 20px;
        color: #051922;
        margin-bottom: 8px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .thumbnails-header h4 i {
        color: #4CAF50;
    }

    .thumbnails-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
    }

    .thumbnail-card {
        background: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    .thumbnail-card:hover {
        transform: translateY(-5px);
    }

    .thumbnail-card img {
        width: 100%;
        height: 120px;
        object-fit: cover;
    }

    .thumbnail-label {
        padding: 10px;
        font-size: 14px;
        font-weight: 600;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .thumbnail-confidence {
        background: #4CAF50;
        color: white;
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 10px;
    }

    /* Adapting drop zone for multi mode */
    .drop-zone.multi-mode .drop-zone-prompt {
        padding: 15px;
    }

    .drop-zone.multi-mode .drop-icon {
        font-size: 30px;
        margin-bottom: 10px;
    }

    .drop-zone.multi-mode .drop-title {
        font-size: 16px;
        margin-bottom: 5px;
    }

    .drop-zone.multi-mode .drop-subtitle {
        font-size: 13px;
        margin-bottom: 15px;
    }

    .drop-zone.multi-mode .btn {
        padding: 10px 20px;
        font-size: 14px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .search-results-grid {
            grid-template-columns: 1fr;
        }

        .search-results-container {
            padding: 15px;
        }

        .recognition-mode-btn {
            min-width: auto;
            padding: 10px 15px;
            font-size: 13px;
        }

        .thumbnails-grid {
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        }
    }

    /* Upload success message */
    .upload-summary {
        background-color: #e7f7ed;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        border-left: 4px solid #4CAF50;
    }

    .upload-success-message {
        display: flex;
        align-items: center;
        color: #2e7d32;
        font-weight: 600;
    }

    .upload-success-message i {
        margin-right: 10px;
        font-size: 20px;
    }
</style>
{% endblock %}

{% block content %}
<!-- Enhanced Breadcrumb Section -->
<section class="breadcrumb-section">
    <div class="container">
        <div class="breadcrumb-content">
            <div class="subtitle">T∆∞∆°i & H·ªØu C∆°</div>
            <h1>Nh·∫≠n Di·ªán Hoa Qu·∫£</h1>
            <p class="description">Kh√°m ph√° th·∫ø gi·ªõi rau c·ªß qu·∫£ t∆∞∆°i ngon v·ªõi c√¥ng ngh·ªá nh·∫≠n di·ªán AI ti√™n ti·∫øn, gi√∫p b·∫°n l·ª±a ch·ªçn s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao, an to√†n v√† nhi·ªÅu dinh d∆∞·ª°ng cho c·∫£ gia ƒë√¨nh.</p>
        </div>
    </div>
</section>
<!-- End Breadcrumb Section -->

<!-- Main Recognition Section -->
<section class="recognition-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="recognition-card fade-in">
                    <div class="card-header">
                        <h2><i class="fas fa-leaf"></i> Nh·∫≠n Di·ªán Th√¥ng Minh</h2>
                        <div class="subtitle">T·∫£i l√™n h√¨nh ·∫£nh hoa qu·∫£ v√† nh·∫≠n k·∫øt qu·∫£ ph√¢n t√≠ch ch√≠nh x√°c trong v√†i gi√¢y</div>
                    </div>

                    <div class="card-body">
                        <!-- Recognition Mode Toggle -->
                        <div class="recognition-mode-toggle" id="recognitionModeToggle">
                            <button class="recognition-mode-btn active" id="singleModeBtn">
                                <i class="fas fa-image"></i> Nh·∫≠n Di·ªán ƒê∆°n ·∫¢nh
                            </button>
                            <button class="recognition-mode-btn" id="multiModeBtn">
                                <i class="fas fa-images"></i> Nh·∫≠n Di·ªán ƒêa ·∫¢nh
                            </button>
                        </div>
                        
                        <!-- Drop Zone -->
                        <div class="drop-zone" id="dropZone">
                            <div class="tips-container" id="recognitionTips">
                                <div class="tips-header">
                                    <i class="fas fa-lightbulb"></i>
                                    <h4>M·∫πo Nh·∫≠n Di·ªán Ch√≠nh X√°c</h4>
                                </div>
                                <div class="tips-content">
                                    <ul>
                                        <li><i class="fas fa-check-circle"></i> Ch·ª•p ·∫£nh trong ƒëi·ªÅu ki·ªán √°nh s√°ng t·ªët, tr√°nh b√≥ng ƒë·ªï</li>
                                        <li><i class="fas fa-check-circle"></i> ƒê·∫∑t hoa qu·∫£ tr√™n n·ªÅn ƒë∆°n gi·∫£n, t·ªët nh·∫•t l√† m√†u tr·∫Øng</li>
                                        <li><i class="fas fa-check-circle"></i> Ch·ª•p c·∫≠n c·∫£nh, ƒë·∫£m b·∫£o hoa qu·∫£ chi·∫øm ph·∫ßn l·ªõn khung h√¨nh</li>
                                        <li><i class="fas fa-check-circle"></i> Lo·∫°i b·ªè c√°c v·∫≠t th·ªÉ kh√°c xung quanh hoa qu·∫£</li>
                                        <li><i class="fas fa-check-circle"></i> Trong ch·∫ø ƒë·ªô ƒëa ·∫£nh, m·ªói ·∫£nh n√™n ch·ª©a m·ªôt lo·∫°i hoa qu·∫£</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="drop-zone-prompt">
                                <i class="fas fa-cloud-upload-alt drop-icon"></i>
                                <div class="drop-title">K√©o th·∫£ h√¨nh ·∫£nh v√†o ƒë√¢y</div>
                                <div class="drop-subtitle">ho·∫∑c nh·∫•n v√†o ƒë·ªÉ ch·ªçn file t·ª´ thi·∫øt b·ªã c·ªßa b·∫°n</div>
                                <div class="btn btn-secondary">
                                    <i class="fas fa-image"></i> Ch·ªçn H√¨nh ·∫¢nh
                                </div>
                            </div>
                            <img class="preview-image" id="previewImage" src="#" alt="Preview">
                            <div class="multi-image-container" id="multiImageContainer" style="display: none;"></div>
                            <input type="file" class="file-input" id="fruit360-imageUpload" accept="image/*">
                        </div>

                        <!-- Upload Controls -->
                        <div class="upload-controls">
                            <button class="btn btn-secondary" id="changeImageBtn">
                                <i class="fas fa-exchange-alt"></i> Thay ƒê·ªïi ·∫¢nh
                            </button>
                            <button class="btn btn-primary btn-large" id="recognizeBtn" disabled>
                                <i class="fas fa-search"></i> Nh·∫≠n Di·ªán Ngay
                            </button>
                        </div>

                        <!-- Loading State -->
                        <div class="loading-container" id="loadingContainer">
                            <div class="spinner"></div>
                            <div class="loading-text">ƒêang ph√¢n t√≠ch h√¨nh ·∫£nh...</div>
                        </div>

                        <!-- Results Container -->
                        <div class="results-container" id="resultsContainer">
                            <div class="results-header">
                                <h3 class="results-title"><i class="fas fa-check-circle"></i> K·∫øt Qu·∫£ Nh·∫≠n Di·ªán</h3>
                                <div class="results-actions">
                                    <button id="shareResultsBtn" title="Chia s·∫ª k·∫øt qu·∫£">
                                        <i class="fas fa-share-alt"></i>
                                    </button>
                                    <button id="downloadResultsBtn" title="T·∫£i v·ªÅ k·∫øt qu·∫£">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="resultsList"></div>
                        </div>

                        <!-- Search Results Container -->
                        <div class="search-results-container" id="searchResultsContainer" style="display: none;">
                            <div class="search-results-header">
                                <h4>üîç T√¨m ki·∫øm ·∫£nh t∆∞∆°ng t·ª±</h4>
                                <p class="search-reason"></p>
                            </div>
                            <div class="search-results-grid" id="searchResultsList">
                                <!-- Results will be inserted here -->
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Recognition Section -->

<!-- Featured Products Section -->
<section class="featured-section">
    <div class="container">
        <div class="section-title-wrap fade-in">
            <div class="section-subtitle">Kh√°m Ph√°</div>
            <h2 class="section-title">S·∫£n Ph·∫©m N·ªïi B·∫≠t</h2>
        </div>

        <div class="category-filter fade-in">
            <button class="filter-btn active" data-filter="all">T·∫•t C·∫£</button>
            <button class="filter-btn" data-filter="strawberry">D√¢u T√¢y</button>
            <button class="filter-btn" data-filter="berry">Qu·∫£ M·ªçng</button>
            <button class="filter-btn" data-filter="tropical">Nhi·ªát ƒê·ªõi</button>
            <button class="filter-btn" data-filter="citrus">H·ªç Cam Qu√Ωt</button>
            <button class="filter-btn" data-filter="organic">H·ªØu C∆°</button>
        </div>

        <div class="product-grid fade-in">
            <!-- Product 1 -->
            <div class="product-card" data-category="strawberry">
                <span class="product-badge badge-new">M·ªõi</span>
                <div class="product-thumb">
                    <img src="{{ url_for('static', filename='assets/img/products/product-img-1.jpg') }}" alt="D√¢u t√¢y">
                    <div class="product-actions">
                        <a class="action-btn" title="Y√™u th√≠ch"><i class="far fa-heart"></i></a>
                        <a class="action-btn" title="So s√°nh"><i class="fas fa-exchange-alt"></i></a>
                        <a class="action-btn" title="Xem nhanh"><i class="far fa-eye"></i></a>
                    </div>
                </div>
                <div class="product-info">
                    <div class="product-category">D√¢u T√¢y</div>
                    <h3 class="product-title">D√¢u T√¢y ƒê√† L·∫°t Premium</h3>
                    <div class="product-price">
                        <span class="current-price">95.000ƒë</span>
                        <span class="old-price">120.000ƒë</span>
                    </div>
                    <button class="add-to-cart">
                        <i class="fas fa-shopping-cart"></i> Th√™m v√†o gi·ªè
                    </button>
                </div>
            </div>

            <!-- Product 2 -->
            <div class="product-card" data-category="berry">
                <div class="product-thumb">
                    <img src="{{ url_for('static', filename='assets/img/products/product-img-2.jpg') }}" alt="Qu·∫£ m·ªçng">
                    <div class="product-actions">
                        <a class="action-btn" title="Y√™u th√≠ch"><i class="far fa-heart"></i></a>
                        <a class="action-btn" title="So s√°nh"><i class="fas fa-exchange-alt"></i></a>
                        <a class="action-btn" title="Xem nhanh"><i class="far fa-eye"></i></a>
                    </div>
                </div>
                <div class="product-info">
                    <div class="product-category">Qu·∫£ M·ªçng</div>
                    <h3 class="product-title">Qu·∫£ M·ªçng H·ªón H·ª£p</h3>
                    <div class="product-price">
                        <span class="current-price">85.000ƒë</span>
                    </div>
                    <button class="add-to-cart">
                        <i class="fas fa-shopping-cart"></i> Th√™m v√†o gi·ªè
                    </button>
                </div>
            </div>

            <!-- Product 3 -->
            <div class="product-card" data-category="citrus">
                <span class="product-badge badge-sale">Gi·∫£m 15%</span>
                <div class="product-thumb">
                    <img src="{{ url_for('static', filename='assets/img/products/product-img-3.jpg') }}" alt="Chanh v√†ng">
                    <div class="product-actions">
                        <a class="action-btn" title="Y√™u th√≠ch"><i class="far fa-heart"></i></a>
                        <a class="action-btn" title="So s√°nh"><i class="fas fa-exchange-alt"></i></a>
                        <a class="action-btn" title="Xem nhanh"><i class="far fa-eye"></i></a>
                    </div>
                </div>
                <div class="product-info">
                    <div class="product-category">H·ªç Cam Qu√Ωt</div>
                    <h3 class="product-title">Chanh V√†ng Nh·∫≠p Kh·∫©u</h3>
                    <div class="product-price">
                        <span class="current-price">59.500ƒë</span>
                        <span class="old-price">70.000ƒë</span>
                    </div>
                    <button class="add-to-cart">
                        <i class="fas fa-shopping-cart"></i> Th√™m v√†o gi·ªè
                    </button>
                </div>
            </div>
        </div>

        <div class="see-more-wrap fade-in">
            <a href="#" class="btn btn-primary btn-large">
                <i class="fas fa-plus"></i> Xem Th√™m S·∫£n Ph·∫©m
            </a>
        </div>
    </div>
</section>
<!-- End Featured Products Section -->

{% endblock %}

{% block extra_js %}

{% endblock %}